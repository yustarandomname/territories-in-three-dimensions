import{S as P,i as F,s as X,C as xe,k,a as $e,l as D,m as M,h as R,c as en,n as v,p as E,b as I,K as a,ab as C,ac as _,D as nn,E as tn,F as rn,g as Y,d as B,M as an,W as sn,o as ln,$ as U,P as s,w as N,_ as on,H as O,N as un,y as j,z as G,A as H,B as W}from"./index.2ecf17a4.js";import{r as hn}from"./index.0449cfc6.js";class dn{currentLayerId;setups;renderers;dispatchers;needsSetup;needsRedraw;context;width;height;autoclear;pixelRatio;renderLoop;layerObserver;layerRef;layerSequence;renderingLayerId;activeLayerId;activeLayerDispatcher;constructor(){this.register=this.register.bind(this),this.unregister=this.unregister.bind(this),this.redraw=this.redraw.bind(this),this.getRenderingLayerId=this.getRenderingLayerId.bind(this),this.currentLayerId=1,this.setups=new Map,this.renderers=new Map,this.dispatchers=new Map,this.needsSetup=!1,this.needsRedraw=!0,this.renderingLayerId=0,this.activeLayerId=0,this.layerSequence=[]}redraw(){this.needsRedraw=!0}register({setup:n,render:i,dispatcher:r}){return n&&(this.setups.set(this.currentLayerId,n),this.needsSetup=!0),this.renderers.set(this.currentLayerId,i),this.dispatchers.set(this.currentLayerId,r),this.needsRedraw=!0,this.currentLayerId++}unregister(n){this.renderers.delete(n),this.dispatchers.delete(n),this.needsRedraw=!0}setup(n,i){this.context=n,this.layerRef=i,this.observeLayerSequence(),this.startRenderLoop()}observeLayerSequence(){this.layerObserver=new MutationObserver(this.getLayerSequence.bind(this)),this.layerObserver.observe(this.layerRef,{childList:!0}),this.getLayerSequence()}getLayerSequence(){const n=[...this.layerRef.children];this.layerSequence=n.map(i=>+(i.dataset.layerId??-1)),this.redraw()}startRenderLoop(){this.render(),this.renderLoop=requestAnimationFrame(()=>this.startRenderLoop())}render(){const n=this.context,i=this.width,r=this.height,l=this.pixelRatio;if(this.needsSetup){for(const[h,g]of this.setups)g({context:n,width:i,height:r}),this.setups.delete(h);this.needsSetup=!1}if(this.needsRedraw){n.setTransform(l,0,0,l,0,0),this.autoclear&&n.clearRect(0,0,i,r);for(const h of this.layerSequence)this.renderingLayerId=h,this.renderers.get(h)?.({context:n,width:i,height:r});this.needsRedraw=!1}}setActiveLayer(n,i){this.activeLayerId!==n&&(i instanceof MouseEvent&&(this.dispatchLayerEvent(new PointerEvent("pointerleave",i)),this.dispatchLayerEvent(new MouseEvent("mouseleave",i))),this.activeLayerId=n,this.activeLayerDispatcher=this.dispatchers.get(n),i instanceof MouseEvent&&(this.dispatchLayerEvent(new PointerEvent("pointerenter",i)),this.dispatchLayerEvent(new MouseEvent("mouseenter",i))))}dispatchLayerEvent(n){if(this.activeLayerDispatcher){if(window.TouchEvent&&n instanceof TouchEvent){const{left:i,top:r}=n.target.getBoundingClientRect(),{clientX:l,clientY:h}=n.changedTouches[0],g={x:l-i,y:h-r,originalEvent:n};this.activeLayerDispatcher(n.type,g)}else if(n instanceof MouseEvent){const i={x:n.offsetX,y:n.offsetY,originalEvent:n};this.activeLayerDispatcher(n.type,i)}}}getRenderingLayerId(){return this.renderingLayerId}destroy(){typeof window>"u"||(this.layerObserver.disconnect(),cancelAnimationFrame(this.renderLoop))}}const cn=e=>{const n=e*2,i=n>>16&255,r=n>>8&255,l=n&255;return`rgb(${i}, ${r}, ${l})`},fn=(e,n,i)=>{const r=(e<<16|n<<8|i)/2;return r%1?0:r},gn=["drawImage"],yn=["filter","shadowBlur","globalCompositeOperation","globalAlpha"],pn=["drawImage","fill","fillRect","fillText","stroke","strokeRect","strokeText"],_n=e=>{let n;const i=document.createElement("canvas"),r=i.getContext("2d",{willReadFrequently:!0}),l=()=>{i.width=e.canvas.width,i.height=e.canvas.height};return new MutationObserver(l).observe(e.canvas,{attributeFilter:["width","height"]}),l(),new Proxy(e,{get(g,d){if(d==="_getLayerIdAtPixel")return(m,o)=>{const[w,p,c]=r.getImageData(m,o,1,1).data;return fn(w,p,c)};const u=g[d];return typeof u!="function"?u:function(...m){if(pn.includes(d)){const o=cn(n());r.fillStyle=o,r.strokeStyle=o}if(d==="drawImage"){const o=m.slice(1);r.fillRect(...o)}return gn.includes(d)||Reflect.apply(u,r,m),Reflect.apply(u,g,m)}},set(g,d,u){return d==="_renderingLayerId"?(n=u,!0):(g[d]=u,yn.includes(d)||(r[d]=u),!0)}})};function mn(e){let n,i,r,l=`${e[0]}px`,h=`${e[1]}px`,g,d,u,m,o;const w=e[18].default,p=xe(w,e,e[17],null);return{c(){n=k("canvas"),g=$e(),d=k("div"),p&&p.c(),this.h()},l(c){n=D(c,"CANVAS",{width:!0,height:!0,class:!0,style:!0}),M(n).forEach(R),g=en(c),d=D(c,"DIV",{});var f=M(d);p&&p.l(f),f.forEach(R),this.h()},h(){v(n,"width",i=e[0]*e[5]),v(n,"height",r=e[1]*e[5]),v(n,"class",e[4]),v(n,"style",e[2]),E(n,"display","block"),E(n,"width",l),E(n,"height",h),E(d,"display","none")},m(c,f){I(c,n,f),e[64](n),I(c,g,f),I(c,d,f),p&&p.m(d,null),e[65](d),u=!0,m||(o=[a(n,"touchstart",C(function(){_(e[3]?e[9]:null)&&(e[3]?e[9]:null).apply(this,arguments)})),a(n,"mousemove",function(){_(e[3]?e[8]:null)&&(e[3]?e[8]:null).apply(this,arguments)}),a(n,"pointermove",function(){_(e[3]?e[8]:null)&&(e[3]?e[8]:null).apply(this,arguments)}),a(n,"click",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"contextmenu",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"dblclick",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"mousedown",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"mouseenter",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"mouseleave",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"mouseup",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"wheel",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"touchcancel",C(function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)})),a(n,"touchend",C(function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)})),a(n,"touchmove",C(function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)})),a(n,"pointerenter",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"pointerleave",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"pointerdown",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"pointerup",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"pointercancel",function(){_(e[3]?e[10]:null)&&(e[3]?e[10]:null).apply(this,arguments)}),a(n,"focus",e[19]),a(n,"blur",e[20]),a(n,"fullscreenchange",e[21]),a(n,"fullscreenerror",e[22]),a(n,"scroll",e[23]),a(n,"cut",e[24]),a(n,"copy",e[25]),a(n,"paste",e[26]),a(n,"keydown",e[27]),a(n,"keypress",e[28]),a(n,"keyup",e[29]),a(n,"auxclick",e[30]),a(n,"click",e[31]),a(n,"contextmenu",e[32]),a(n,"dblclick",e[33]),a(n,"mousedown",e[34]),a(n,"mouseenter",e[35]),a(n,"mouseleave",e[36]),a(n,"mousemove",e[37]),a(n,"mouseover",e[38]),a(n,"mouseout",e[39]),a(n,"mouseup",e[40]),a(n,"select",e[41]),a(n,"wheel",e[42]),a(n,"drag",e[43]),a(n,"dragend",e[44]),a(n,"dragenter",e[45]),a(n,"dragstart",e[46]),a(n,"dragleave",e[47]),a(n,"dragover",e[48]),a(n,"drop",e[49]),a(n,"touchcancel",e[50]),a(n,"touchend",e[51]),a(n,"touchmove",e[52]),a(n,"touchstart",e[53]),a(n,"pointerover",e[54]),a(n,"pointerenter",e[55]),a(n,"pointerdown",e[56]),a(n,"pointermove",e[57]),a(n,"pointerup",e[58]),a(n,"pointercancel",e[59]),a(n,"pointerout",e[60]),a(n,"pointerleave",e[61]),a(n,"gotpointercapture",e[62]),a(n,"lostpointercapture",e[63])],m=!0)},p(c,f){e=c,(!u||f[0]&33&&i!==(i=e[0]*e[5]))&&v(n,"width",i),(!u||f[0]&34&&r!==(r=e[1]*e[5]))&&v(n,"height",r),(!u||f[0]&16)&&v(n,"class",e[4]),(!u||f[0]&4)&&v(n,"style",e[2]);const L=f[0]&4;L&&E(n,"display","block"),(L||f[0]&5&&l!==(l=`${e[0]}px`))&&E(n,"width",l),(L||f[0]&6&&h!==(h=`${e[1]}px`))&&E(n,"height",h),p&&p.p&&(!u||f[0]&131072)&&nn(p,w,e,e[17],u?rn(w,e[17],f,null):tn(e[17]),null)},i(c){u||(Y(p,c),u=!0)},o(c){B(p,c),u=!1},d(c){c&&R(n),e[64](null),c&&R(g),c&&R(d),p&&p.d(c),e[65](null),m=!1,an(o)}}}const J=Symbol(),vn=()=>on(J);function wn(e,n,i){let r,{$$slots:l={},$$scope:h}=n,{width:g=640,height:d=640,pixelRatio:u=null,style:m="",autoclear:o=!0,layerEvents:w=!1}=n,{class:p=""}=n,c,f=null,L;const y=new dn;function T(){y.redraw()}function b(){return c}function S(){return f}u==null&&(typeof window<"u"?u=window.devicePixelRatio:u=2),sn(J,{register:y.register,unregister:y.unregister,redraw:y.redraw}),ln(()=>{const t=c.getContext("2d");w?(f=_n(t),f._renderingLayerId=y.getRenderingLayerId):f=t,y.setup(f,L)}),U(()=>y.destroy());const x=t=>{const A=t.offsetX*r,q=t.offsetY*r,z=f._getLayerIdAtPixel(A,q);y.setActiveLayer(z,t),y.dispatchLayerEvent(t)},$=t=>{const{clientX:A,clientY:q}=t.changedTouches[0],{left:z,top:We}=c.getBoundingClientRect(),Je=(A-z)*r,Qe=(q-We)*r,Ze=f._getLayerIdAtPixel(Je,Qe);y.setActiveLayer(Ze,t),y.dispatchLayerEvent(t)},ee=t=>{window.TouchEvent&&t instanceof TouchEvent&&t.preventDefault(),y.dispatchLayerEvent(t)};function ne(t){s.call(this,e,t)}function te(t){s.call(this,e,t)}function ie(t){s.call(this,e,t)}function re(t){s.call(this,e,t)}function ae(t){s.call(this,e,t)}function se(t){s.call(this,e,t)}function le(t){s.call(this,e,t)}function oe(t){s.call(this,e,t)}function ue(t){s.call(this,e,t)}function he(t){s.call(this,e,t)}function de(t){s.call(this,e,t)}function ce(t){s.call(this,e,t)}function fe(t){s.call(this,e,t)}function ge(t){s.call(this,e,t)}function ye(t){s.call(this,e,t)}function pe(t){s.call(this,e,t)}function _e(t){s.call(this,e,t)}function me(t){s.call(this,e,t)}function ve(t){s.call(this,e,t)}function we(t){s.call(this,e,t)}function Le(t){s.call(this,e,t)}function be(t){s.call(this,e,t)}function Re(t){s.call(this,e,t)}function Ee(t){s.call(this,e,t)}function Ie(t){s.call(this,e,t)}function Se(t){s.call(this,e,t)}function Ce(t){s.call(this,e,t)}function ke(t){s.call(this,e,t)}function De(t){s.call(this,e,t)}function Me(t){s.call(this,e,t)}function Te(t){s.call(this,e,t)}function Ae(t){s.call(this,e,t)}function qe(t){s.call(this,e,t)}function ze(t){s.call(this,e,t)}function Oe(t){s.call(this,e,t)}function Pe(t){s.call(this,e,t)}function Fe(t){s.call(this,e,t)}function Xe(t){s.call(this,e,t)}function Ye(t){s.call(this,e,t)}function Be(t){s.call(this,e,t)}function Ne(t){s.call(this,e,t)}function Ve(t){s.call(this,e,t)}function Ke(t){s.call(this,e,t)}function Ue(t){s.call(this,e,t)}function je(t){s.call(this,e,t)}function Ge(t){N[t?"unshift":"push"](()=>{c=t,i(6,c)})}function He(t){N[t?"unshift":"push"](()=>{L=t,i(7,L)})}return e.$$set=t=>{"width"in t&&i(0,g=t.width),"height"in t&&i(1,d=t.height),"pixelRatio"in t&&i(11,u=t.pixelRatio),"style"in t&&i(2,m=t.style),"autoclear"in t&&i(12,o=t.autoclear),"layerEvents"in t&&i(3,w=t.layerEvents),"class"in t&&i(4,p=t.class),"$$scope"in t&&i(17,h=t.$$scope)},e.$$.update=()=>{e.$$.dirty[0]&2048&&i(5,r=u??1),e.$$.dirty[0]&1&&i(16,y.width=g,y),e.$$.dirty[0]&2&&i(16,y.height=d,y),e.$$.dirty[0]&32&&i(16,y.pixelRatio=r,y),e.$$.dirty[0]&4096&&i(16,y.autoclear=o,y),e.$$.dirty[0]&71683&&y.redraw()},[g,d,m,w,p,r,c,L,x,$,ee,u,o,T,b,S,y,h,l,ne,te,ie,re,ae,se,le,oe,ue,he,de,ce,fe,ge,ye,pe,_e,me,ve,we,Le,be,Re,Ee,Ie,Se,Ce,ke,De,Me,Te,Ae,qe,ze,Oe,Pe,Fe,Xe,Ye,Be,Ne,Ve,Ke,Ue,je,Ge,He]}class Ln extends P{constructor(n){super(),F(this,n,wn,mn,X,{width:0,height:1,pixelRatio:11,style:2,autoclear:12,layerEvents:3,class:4,redraw:13,getCanvas:14,getContext:15},null,[-1,-1,-1])}get redraw(){return this.$$.ctx[13]}get getCanvas(){return this.$$.ctx[14]}get getContext(){return this.$$.ctx[15]}}function bn(e){let n;return{c(){n=k("div"),this.h()},l(i){n=D(i,"DIV",{"data-layer-id":!0}),M(n).forEach(R),this.h()},h(){v(n,"data-layer-id",e[0])},m(i,r){I(i,n,r)},p:O,i:O,o:O,d(i){i&&R(n)}}}function Rn(e,n,i){const{register:r,unregister:l,redraw:h}=vn(),g=un();let{setup:d=void 0}=n,{render:u=()=>{}}=n;const m=r({setup:d,render:u,dispatcher:g});return U(()=>l(m)),e.$$set=o=>{"setup"in o&&i(1,d=o.setup),"render"in o&&i(2,u=o.render)},e.$$.update=()=>{e.$$.dirty&4&&h()},[m,d,u]}class En extends P{constructor(n){super(),F(this,n,Rn,bn,X,{setup:1,render:2})}}let V;const Q=Date.now(),Z=e=>(e(Date.now()-Q),V=window.requestAnimationFrame(()=>Z(e)),()=>window.cancelAnimationFrame(V));function In(){}hn(Date.now()-Q,typeof window>"u"?In:Z);function Sn(e){let n,i;return n=new En({props:{render:e[1]}}),{c(){j(n.$$.fragment)},l(r){G(n.$$.fragment,r)},m(r,l){H(n,r,l),i=!0},p(r,l){const h={};l&2&&(h.render=r[1]),n.$set(h)},i(r){i||(Y(n.$$.fragment,r),i=!0)},o(r){B(n.$$.fragment,r),i=!1},d(r){W(n,r)}}}function Cn(e){let n,i,r;return i=new Ln({props:{class:"w-full",height:640,$$slots:{default:[Sn]},$$scope:{ctx:e}}}),{c(){n=k("div"),j(i.$$.fragment),this.h()},l(l){n=D(l,"DIV",{id:!0,class:!0});var h=M(n);G(i.$$.fragment,h),h.forEach(R),this.h()},h(){v(n,"id",e[0]),v(n,"class","w-full h-full flex justify-center items-center")},m(l,h){I(l,n,h),H(i,n,null),r=!0},p(l,[h]){const g={};h&130&&(g.$$scope={dirty:h,ctx:l}),i.$set(g),(!r||h&1)&&v(n,"id",l[0])},i(l){r||(Y(i.$$.fragment,l),r=!0)},o(l){B(i.$$.fragment,l),r=!1},d(l){l&&R(n),W(i)}}}function K(e,n,i=1){return Array.from({length:n-e},(r,l)=>e+l*i)}function kn(e,n,i){let{universe:r}=n,{isSliding:l=!1}=n,{sliceIndex:h=0}=n,{offset:g=0}=n,{mayority:d=!1}=n,{id:u="canvas"}=n,m;return e.$$set=o=>{"universe"in o&&i(2,r=o.universe),"isSliding"in o&&i(3,l=o.isSliding),"sliceIndex"in o&&i(4,h=o.sliceIndex),"offset"in o&&i(5,g=o.offset),"mayority"in o&&i(6,d=o.mayority),"id"in o&&i(0,u=o.id)},e.$$.update=()=>{e.$$.dirty&124&&i(1,m=({context:o,width:w,height:p})=>{let c=w/r.size,f=p/r.size;for(const L of K(0,r.size))for(const y of K(0,r.size)){let T=y+L*r.size+g,b=r.nodes[T],S=b.blue_agents+b.red_agents;l&&h!=y||(o.beginPath(),d?b.red_agents>b.blue_agents?o.fillStyle="rgba(255, 0, 0, 0.9)":b.blue_agents>b.red_agents?o.fillStyle="rgba(0, 0, 255, 0.9)":o.fillStyle="rgba(0, 255, 0, 0.9)":o.fillStyle=`rgba(${Math.round(255*(b.red_agents/S))}, 0, ${Math.round(255*(b.blue_agents/S))}, 0.9)`,o.fillRect(c*y,f*L,c,f),o.closePath())}})},[u,m,r,l,h,g,d]}class Tn extends P{constructor(n){super(),F(this,n,kn,Cn,X,{universe:2,isSliding:3,sliceIndex:4,offset:5,mayority:6,id:0})}}export{Tn as C};
